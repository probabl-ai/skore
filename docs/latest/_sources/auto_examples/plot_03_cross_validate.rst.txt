
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_03_cross_validate.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_plot_03_cross_validate.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_03_cross_validate.py:


.. _example_cross_validate:

==========================
Enhancing cross-validation
==========================

This example illustrates the motivation and the use of skore's
:func:`skore.cross_validate` to get assistance when developing ML/DS projects.

.. GENERATED FROM PYTHON SOURCE LINES 13-15

Creating and loading the skore project
======================================

.. GENERATED FROM PYTHON SOURCE LINES 17-19

We start by creating a temporary directory to store our project so that we can
easily clean it after executing this example:

.. GENERATED FROM PYTHON SOURCE LINES 21-27

.. code-block:: Python

    import tempfile
    from pathlib import Path

    temp_dir = tempfile.TemporaryDirectory(prefix="skore_example_")
    temp_dir_path = Path(temp_dir.name)








.. GENERATED FROM PYTHON SOURCE LINES 28-29

We create and load the skore project from this temporary directory:

.. GENERATED FROM PYTHON SOURCE LINES 31-35

.. code-block:: Python

    import skore

    my_project = skore.create("my_project", working_dir=temp_dir_path)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [11/28/24 14:44:28] <Logger skore.project.project (INFO)> Project  create.py:148
                                                              file                  
                                                              '/tmp/sk              
                                                              ore_exam              
                                                              ple_qsbc              
                                                              3hci/my_              
                                                              project.              
                                                              skore'                
                                                              was                   
                                                              successf              
                                                              ully                  
                                                              created.              




.. GENERATED FROM PYTHON SOURCE LINES 36-54

Cross-validation in scikit-learn
================================

Scikit-learn holds two functions for cross-validation:

* :func:`sklearn.model_selection.cross_val_score`
* :func:`sklearn.model_selection.cross_validate`

Essentially, :func:`sklearn.model_selection.cross_val_score` runs cross-validation for
single metric evaluation, while :func:`sklearn.model_selection.cross_validate` runs
cross-validation with multiple metrics and can also return extra information such as
train scores, fit times, and score times.

Hence, in skore, we are more interested in the
:func:`sklearn.model_selection.cross_validate` function as it allows to do
more than the historical :func:`sklearn.model_selection.cross_val_score`.

Let us illustrate cross-validation on a multi-class classification task.

.. GENERATED FROM PYTHON SOURCE LINES 56-62

.. code-block:: Python

    from sklearn.datasets import load_iris
    from sklearn.svm import SVC

    X, y = load_iris(return_X_y=True)
    clf = SVC(kernel="linear", C=1, random_state=0)








.. GENERATED FROM PYTHON SOURCE LINES 63-64

Single metric evaluation using :func:`sklearn.model_selection.cross_validate`:

.. GENERATED FROM PYTHON SOURCE LINES 66-71

.. code-block:: Python

    from sklearn.model_selection import cross_validate as sklearn_cross_validate

    cv_results = sklearn_cross_validate(clf, X, y, cv=5)
    print(f"test_score: {cv_results['test_score']}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    test_score: [0.96666667 1.         0.96666667 0.96666667 1.        ]




.. GENERATED FROM PYTHON SOURCE LINES 72-73

Multiple metric evaluation using :func:`sklearn.model_selection.cross_validate`:

.. GENERATED FROM PYTHON SOURCE LINES 75-87

.. code-block:: Python

    import pandas as pd

    cv_results = sklearn_cross_validate(
        clf,
        X,
        y,
        cv=5,
        scoring=["accuracy", "precision_macro"],
    )
    test_scores = pd.DataFrame(cv_results)[["test_accuracy", "test_precision_macro"]]
    test_scores






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>test_accuracy</th>
          <th>test_precision_macro</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>0.966667</td>
          <td>0.969697</td>
        </tr>
        <tr>
          <th>1</th>
          <td>1.000000</td>
          <td>1.000000</td>
        </tr>
        <tr>
          <th>2</th>
          <td>0.966667</td>
          <td>0.969697</td>
        </tr>
        <tr>
          <th>3</th>
          <td>0.966667</td>
          <td>0.969697</td>
        </tr>
        <tr>
          <th>4</th>
          <td>1.000000</td>
          <td>1.000000</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 88-106

In scikit-learn, why do we recommend using ``cross_validate`` over ``cross_val_score``?
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Here, for the :class:`~sklearn.svm.SVC`, the default score is the accuracy.
If the users want other scores to better understand their model such as the
precision and the recall, they can specify it which is very convenient.
Otherwise, they would have to run several
:func:`sklearn.model_selection.cross_val_score` with different ``scoring``
parameters each time, which leads to more unnecessary compute.

Why do we recommend using skore's ``cross_validate`` over scikit-learn's?
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

In the example above, what if the users ran scikit-learn's
:func:`sklearn.model_selection.cross_validate` but forgot to manually add a
crucial score for their use case such as the recall?
They would have to re-run the whole cross-validation experiment by adding this
crucial score, which leads to more compute.

.. GENERATED FROM PYTHON SOURCE LINES 108-120

Cross-validation in skore
=========================

In order to assist its users when programming, skore has implemented a
:func:`skore.cross_validate` function that wraps scikit-learn's
:func:`sklearn.model_selection.cross_validate`, to provide more
context and facilitate the analysis.

Classification task
^^^^^^^^^^^^^^^^^^^

Let us continue with the same use case.

.. GENERATED FROM PYTHON SOURCE LINES 122-127

.. code-block:: Python

    cv_results = skore.cross_validate(clf, X, y, cv=5, project=my_project)

    fig_plotly_clf = my_project.get_item("cross_validation").plot
    fig_plotly_clf






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
            <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="5c8dea7b-9951-427b-ac97-31262a731510" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("5c8dea7b-9951-427b-ac97-31262a731510")) {                    Plotly.newPlot(                        "5c8dea7b-9951-427b-ac97-31262a731510",                        [{"hovertemplate":"%{y}","legendgroup":"group0","marker":{"color":"#636EFA"},"name":"test_score","showlegend":true,"visible":true,"x":[0,1,2,3,4],"y":[0.9666666666666667,1.0,0.9666666666666667,0.9666666666666667,1.0],"type":"bar"},{"hovertemplate":"%{y}","legendgroup":"group0","line":{"color":"#636EFA","dash":"dash"},"mode":"lines","name":"Average test_score","showlegend":false,"visible":true,"x":[-0.5,4.5],"y":[0.9800000000000001,0.9800000000000001],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group0","line":{"color":"#636EFA","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. test_score","showlegend":false,"visible":true,"x":[-0.5,4.5],"y":[0.9982574185835056,0.9982574185835056],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group0","line":{"color":"#636EFA","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. test_score","showlegend":false,"visible":true,"x":[-0.5,4.5],"y":[0.9617425814164946,0.9617425814164946],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group1","marker":{"color":"#EF553B"},"name":"test_recall_weighted","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[0.9666666666666667,1.0,0.9666666666666667,0.9666666666666667,1.0],"type":"bar"},{"hovertemplate":"%{y}","legendgroup":"group1","line":{"color":"#EF553B","dash":"dash"},"mode":"lines","name":"Average test_recall_weighted","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.9800000000000001,0.9800000000000001],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group1","line":{"color":"#EF553B","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. test_recall_weighted","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.9982574185835056,0.9982574185835056],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group1","line":{"color":"#EF553B","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. test_recall_weighted","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.9617425814164946,0.9617425814164946],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group2","marker":{"color":"#00CC96"},"name":"test_precision_weighted","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[0.9696969696969696,1.0,0.9696969696969696,0.9696969696969696,1.0],"type":"bar"},{"hovertemplate":"%{y}","legendgroup":"group2","line":{"color":"#00CC96","dash":"dash"},"mode":"lines","name":"Average test_precision_weighted","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.9818181818181818,0.9818181818181818],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group2","line":{"color":"#00CC96","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. test_precision_weighted","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.9984158350759141,0.9984158350759141],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group2","line":{"color":"#00CC96","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. test_precision_weighted","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.9652205285604495,0.9652205285604495],"type":"scatter"},{"customdata":["0:00:00.000818","0:00:00.000838","0:00:00.000792","0:00:00.000827","0:00:00.000814"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","marker":{"color":"#AB63FA"},"name":"fit_time (seconds)","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[0.0008182525634765625,0.0008375644683837891,0.0007920265197753906,0.0008270740509033203,0.0008137226104736328],"type":"bar"},{"customdata":["0:00:00.000818","0:00:00.000838","0:00:00.000792","0:00:00.000827","0:00:00.000814"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","line":{"color":"#AB63FA","dash":"dash"},"mode":"lines","name":"Average fit_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0008177280426025391,0.0008177280426025391],"type":"scatter"},{"customdata":["0:00:00.000818","0:00:00.000838","0:00:00.000792","0:00:00.000827","0:00:00.000814"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","line":{"color":"#AB63FA","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. fit_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0008347406742570944,0.0008347406742570944],"type":"scatter"},{"customdata":["0:00:00.000818","0:00:00.000838","0:00:00.000792","0:00:00.000827","0:00:00.000814"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","line":{"color":"#AB63FA","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. fit_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0008007154109479838,0.0008007154109479838],"type":"scatter"},{"customdata":["0:00:00.002869","0:00:00.002771","0:00:00.002705","0:00:00.002715","0:00:00.002676"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","marker":{"color":"#FFA15A"},"name":"score_time (seconds)","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[0.002869129180908203,0.0027713775634765625,0.0027048587799072266,0.0027146339416503906,0.0026764869689941406],"type":"bar"},{"customdata":["0:00:00.002869","0:00:00.002771","0:00:00.002705","0:00:00.002715","0:00:00.002676"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","line":{"color":"#FFA15A","dash":"dash"},"mode":"lines","name":"Average score_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0027472972869873047,0.0027472972869873047],"type":"scatter"},{"customdata":["0:00:00.002869","0:00:00.002771","0:00:00.002705","0:00:00.002715","0:00:00.002676"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","line":{"color":"#FFA15A","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. score_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0028236269867086936,0.0028236269867086936],"type":"scatter"},{"customdata":["0:00:00.002869","0:00:00.002771","0:00:00.002705","0:00:00.002715","0:00:00.002676"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","line":{"color":"#FFA15A","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. score_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.002670967587265916,0.002670967587265916],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"text":"Cross-validation results for each split"},"xaxis":{"dtick":1,"tickmode":"linear","title":{"text":"Split number"}},"yaxis":{"title":{"text":"Value"}}},                        {"responsive": true}                    )                };                            </script>        </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 128-144

Skore's :func:`~skore.cross_validate` advantages are the following:

* By default, it computes several useful scores without the need to
  manually specify them. For classification, one can observe that it computed the
  accuracy, the precision, and the recall.

* We automatically get some interactive Plotly graphs to better understand how our
  model behaves depending on the split. For example:

  * We can compare the fitting and scoring times together for each split.

  * We can compare the accuracy, precision, and recall scores together for each
    split.

* The results and plots are automatically saved in our skore project, so that we can
  visualize them later in the UI for example.

.. GENERATED FROM PYTHON SOURCE LINES 146-148

Regression task
^^^^^^^^^^^^^^^

.. GENERATED FROM PYTHON SOURCE LINES 150-155

For now, all cross-validation runs store their results in the same place, which might
lead to comparing two different models that are actually not comparable (e.g.
comparing a regression with a classification).
To remedy this, we clear the cross-validation information stored in skore before
running another unrelated cross-validation:

.. GENERATED FROM PYTHON SOURCE LINES 157-160

.. code-block:: Python

    my_project.delete_item("cross_validation")
    my_project.delete_item("cross_validation_aggregated")








.. GENERATED FROM PYTHON SOURCE LINES 161-164

.. note::
  Soon, the storage of several unrelated cross-validation runs will be managed
  automatically.

.. GENERATED FROM PYTHON SOURCE LINES 166-179

.. code-block:: Python

    from sklearn.datasets import load_diabetes
    from sklearn.linear_model import Lasso

    diabetes = load_diabetes()
    X = diabetes.data[:150]
    y = diabetes.target[:150]
    lasso = Lasso()

    cv_results = skore.cross_validate(lasso, X, y, cv=5, project=my_project)

    fig_plotly_reg = my_project.get_item("cross_validation").plot
    fig_plotly_reg






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
            <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="f718154a-1e34-4203-ab3e-acc35dcf1167" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f718154a-1e34-4203-ab3e-acc35dcf1167")) {                    Plotly.newPlot(                        "f718154a-1e34-4203-ab3e-acc35dcf1167",                        [{"hovertemplate":"%{y}","legendgroup":"group0","marker":{"color":"#636EFA"},"name":"test_score","showlegend":true,"visible":true,"x":[0,1,2,3,4],"y":[0.2982867487756391,0.22414919618930618,0.15480127210175387,0.2551973269039568,0.1710871514478407],"type":"bar"},{"hovertemplate":"%{y}","legendgroup":"group0","line":{"color":"#636EFA","dash":"dash"},"mode":"lines","name":"Average test_score","showlegend":false,"visible":true,"x":[-0.5,4.5],"y":[0.22070433908369935,0.22070433908369935],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group0","line":{"color":"#636EFA","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. test_score","showlegend":false,"visible":true,"x":[-0.5,4.5],"y":[0.27991950413745326,0.27991950413745326],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group0","line":{"color":"#636EFA","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. test_score","showlegend":false,"visible":true,"x":[-0.5,4.5],"y":[0.16148917402994548,0.16148917402994548],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group1","marker":{"color":"#EF553B"},"name":"test_r2","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[0.2982867487756391,0.22414919618930618,0.15480127210175387,0.2551973269039568,0.1710871514478407],"type":"bar"},{"hovertemplate":"%{y}","legendgroup":"group1","line":{"color":"#EF553B","dash":"dash"},"mode":"lines","name":"Average test_r2","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.22070433908369935,0.22070433908369935],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group1","line":{"color":"#EF553B","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. test_r2","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.27991950413745326,0.27991950413745326],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group1","line":{"color":"#EF553B","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. test_r2","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.16148917402994548,0.16148917402994548],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group2","marker":{"color":"#00CC96"},"name":"test_neg_root_mean_squared_error","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[-52.98271412620445,-69.93123859116155,-57.97111409545601,-68.286418279226,-71.77966037436696],"type":"bar"},{"hovertemplate":"%{y}","legendgroup":"group2","line":{"color":"#00CC96","dash":"dash"},"mode":"lines","name":"Average test_neg_root_mean_squared_error","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[-64.19022909328298,-64.19022909328298],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group2","line":{"color":"#00CC96","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. test_neg_root_mean_squared_error","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[-55.949731441964374,-55.949731441964374],"type":"scatter"},{"hovertemplate":"%{y}","legendgroup":"group2","line":{"color":"#00CC96","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. test_neg_root_mean_squared_error","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[-72.43072674460159,-72.43072674460159],"type":"scatter"},{"customdata":["0:00:00.000682","0:00:00.000598","0:00:00.000590","0:00:00.000583","0:00:00.000582"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","marker":{"color":"#AB63FA"},"name":"fit_time (seconds)","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[0.0006821155548095703,0.0005979537963867188,0.0005903244018554688,0.0005826950073242188,0.0005819797515869141],"type":"bar"},{"customdata":["0:00:00.000682","0:00:00.000598","0:00:00.000590","0:00:00.000583","0:00:00.000582"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","line":{"color":"#AB63FA","dash":"dash"},"mode":"lines","name":"Average fit_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0006070137023925781,0.0006070137023925781],"type":"scatter"},{"customdata":["0:00:00.000682","0:00:00.000598","0:00:00.000590","0:00:00.000583","0:00:00.000582"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","line":{"color":"#AB63FA","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. fit_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0006494960531646484,0.0006494960531646484],"type":"scatter"},{"customdata":["0:00:00.000682","0:00:00.000598","0:00:00.000590","0:00:00.000583","0:00:00.000582"],"hovertemplate":"%{customdata}\u003cextra\u003efit_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group3","line":{"color":"#AB63FA","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. fit_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0005645313516205078,0.0005645313516205078],"type":"scatter"},{"customdata":["0:00:00.001201","0:00:00.001114","0:00:00.001142","0:00:00.001078","0:00:00.001108"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","marker":{"color":"#FFA15A"},"name":"score_time (seconds)","showlegend":true,"visible":"legendonly","x":[0,1,2,3,4],"y":[0.0012009143829345703,0.0011141300201416016,0.0011420249938964844,0.0010776519775390625,0.001108407974243164],"type":"bar"},{"customdata":["0:00:00.001201","0:00:00.001114","0:00:00.001142","0:00:00.001078","0:00:00.001108"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","line":{"color":"#FFA15A","dash":"dash"},"mode":"lines","name":"Average score_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0011286258697509766,0.0011286258697509766],"type":"scatter"},{"customdata":["0:00:00.001201","0:00:00.001114","0:00:00.001142","0:00:00.001078","0:00:00.001108"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","line":{"color":"#FFA15A","dash":"dot"},"mode":"lines","name":"Average + 1 std. dev. score_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0011750542993713494,0.0011750542993713494],"type":"scatter"},{"customdata":["0:00:00.001201","0:00:00.001114","0:00:00.001142","0:00:00.001078","0:00:00.001108"],"hovertemplate":"%{customdata}\u003cextra\u003escore_time (timedelta)\u003c\u002fextra\u003e","legendgroup":"group4","line":{"color":"#FFA15A","dash":"dot"},"mode":"lines","name":"Average - 1 std. dev. score_time (seconds)","showlegend":false,"visible":"legendonly","x":[-0.5,4.5],"y":[0.0010821974401306039,0.0010821974401306039],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"text":"Cross-validation results for each split"},"xaxis":{"dtick":1,"tickmode":"linear","title":{"text":"Split number"}},"yaxis":{"title":{"text":"Value"}}},                        {"responsive": true}                    )                };                            </script>        </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 180-183

.. seealso::
  For tracking and comparing several runs of cross-validations on the same data, see
  :ref:`example_track_cv`.

.. GENERATED FROM PYTHON SOURCE LINES 185-189

Cleanup the project
-------------------

Removing the temporary directory:

.. GENERATED FROM PYTHON SOURCE LINES 191-192

.. code-block:: Python

    temp_dir.cleanup()








.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.161 seconds)


.. _sphx_glr_download_auto_examples_plot_03_cross_validate.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_03_cross_validate.ipynb <plot_03_cross_validate.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_03_cross_validate.py <plot_03_cross_validate.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_03_cross_validate.zip <plot_03_cross_validate.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
